@page "/login"
@layout LoginLayout
@inject NavigationManager Navigation
@attribute [AllowAnonymous]

<PageTitle>Login</PageTitle>

<!-- Fond dynamique -->
<div class="login-bg" style="background-image: url('@backgrounds[currentIndex].url'); filter: blur(@backgrounds[currentIndex].blur);"></div>

<div class="position-absolute top-0 end-0 m-3 z-10">
    <MudTooltip Text="Afficher mot de passe">
        <MudIconButton Icon="@Icons.Material.Filled.Visibility" OnClick="@ChangeBackground" />
    </MudTooltip>
</div>

<div class="d-flex justify-content-center align-items-center vh-100">
    <div class="card shadow-lg p-4 login-card">
        <div class="card-body text-center">
            <h3 class="fw-bold mb-4 text-primary">Bienvenue sur Gardien du Bit</h3>
            <MudButton Color="Color.Primary" Variant="Variant.Filled" OnClick="RedirectAuthentication">
                Se Connecter
            </MudButton>
        </div>
    </div>
</div>

@code {

    private int currentIndex = 0;

    private readonly (string url, string blur)[] backgrounds =
    {
        ("/bg-image.gif", "1px"),
        ("/bg-image2.gif", "4px"),
    };

    private void ChangeBackground()
    {
        currentIndex = (currentIndex + 1) % backgrounds.Length;
    }

    private void RedirectAuthentication()
    {
        Navigation.NavigateTo("authentication/login");
    }
}

<style>
    .login-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-size: cover;
        background-position: center;
        transition: background-image 0.5s ease-in-out, filter 0.3s ease;
        z-index: -1;
    }

    .login-card {
        max-width: 400px;
        width: 100%;
        border-radius: 15px;
        background: white;
        position: relative;
        z-index: 1;
    }

    .z-10 {
        z-index: 10;
    }

</style>